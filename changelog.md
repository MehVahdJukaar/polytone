backported many changes. check 1.21 changelogs of past weeks